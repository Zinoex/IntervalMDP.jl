<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Data formats · IntervalMDP.jl</title><meta name="title" content="Data formats · IntervalMDP.jl"/><meta property="og:title" content="Data formats · IntervalMDP.jl"/><meta property="twitter:title" content="Data formats · IntervalMDP.jl"/><meta name="description" content="Documentation for IntervalMDP.jl."/><meta property="og:description" content="Documentation for IntervalMDP.jl."/><meta property="twitter:description" content="Documentation for IntervalMDP.jl."/><meta property="og:url" content="https://www.baymler.com/IntervalMDP.jl/data/"/><meta property="twitter:url" content="https://www.baymler.com/IntervalMDP.jl/data/"/><link rel="canonical" href="https://www.baymler.com/IntervalMDP.jl/data/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="IntervalMDP.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">IntervalMDP.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../usage/">Usage</a></li><li class="is-active"><a class="tocitem" href>Data formats</a><ul class="internal"><li><a class="tocitem" href="#PRISM"><span>PRISM</span></a></li><li><a class="tocitem" href="#bmdp-tool"><span>bmdp-tool</span></a></li><li><a class="tocitem" href="#IntervalMDP.jl"><span>IntervalMDP.jl</span></a></li></ul></li><li><a class="tocitem" href="../theory/">Theory</a></li><li><a class="tocitem" href="../algorithms/">Algorithms</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../reference/systems/">Systems</a></li><li><a class="tocitem" href="../reference/specifications/">Specifications</a></li><li><a class="tocitem" href="../reference/value_iteration/">Value Iteration</a></li><li><a class="tocitem" href="../reference/data/">Data Storage</a></li></ul></li><li><a class="tocitem" href="../api/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Data formats</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Data formats</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Zinoex/IntervalMDP.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Zinoex/IntervalMDP.jl/blob/main/docs/src/data.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Data-storage-formats"><a class="docs-heading-anchor" href="#Data-storage-formats">Data storage formats</a><a id="Data-storage-formats-1"></a><a class="docs-heading-anchor-permalink" href="#Data-storage-formats" title="Permalink"></a></h1><p>IntervalMDP.jl supports reading and writing data in various formats, namely PRISM explicit format, bmdp-tool, and our own format (model and specification). To justify introducing another standard (<a href="https://xkcd.com/927/">see relevant XKCD</a>), note that the PRISM explicit format and the bmdp-tool format are all written in ASCII, which is very inefficient in terms of storage space (especially for storing floating point numbers) and parsing time. We propose a binary format for the most storage-intensive part of the data, namely the transition probabilities, and use JSON for the specification, which is human- and machine-readable and widely used.</p><h2 id="PRISM"><a class="docs-heading-anchor" href="#PRISM">PRISM</a><a id="PRISM-1"></a><a class="docs-heading-anchor-permalink" href="#PRISM" title="Permalink"></a></h2><p>IntervalMDP.jl supports reading and writing <a href="https://www.prismmodelchecker.org/">PRISM</a> [1] explicit data format.  The data format is split into 4 different files, one for the states, one for the labels, one for the transition probabilities, and one for the specification. Therefore, our interface for reading PRISM files takes the path without file ending and adds the appropriate ending to each of the four files.</p><pre><code class="language-julia hljs"># Read
problem = read_prism_file(path_without_file_ending)

# Write
write_prism_file(path_without_file_ending, problem)</code></pre><p>The problem structure contains both the \gls{imdp} and the specification including whether to synthesize a maximizing or minimizing strategy and whether to use an optimistic or pessimistic adversary.</p><p>PRISM uses 4 different ASCII-encoded files to store the explicit representation of the system: &#39;.sta&#39; (states), &#39;.lab&#39; (labels), &#39;.tra&#39; (transitions), and &#39;.pctl&#39; (property). In the tables below, we list the format for each file. The extended details of the PRISM explicit file format can be found in <a href="https://www.prismmodelchecker.org/manual/Appendices/ExplicitModelFiles">the appendix of the PRISM manual</a>.</p><h4 id="States-.sta"><a class="docs-heading-anchor" href="#States-.sta">States .sta</a><a id="States-.sta-1"></a><a class="docs-heading-anchor-permalink" href="#States-.sta" title="Permalink"></a></h4><table><tr><th style="text-align: left">Number of lines</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left">First line</td><td style="text-align: left">The first line containing symbolically <code>(v1, v2, ..., vn)</code> is a list of <span>$n$</span> variables in the model.</td></tr><tr><td style="text-align: left"><span>$m$</span> lines where <span>$m$</span> is the number of states</td><td style="text-align: left">Each line contains <code>i:(v1, v2, ..., vn)</code> where <code>i</code> is the index of the state and <code>(v1, v2, ..., vn)</code>` is an assignment of values to the variables in the model. Indices are zero-indexed.</td></tr></table><h4 id="Labels-.lab"><a class="docs-heading-anchor" href="#Labels-.lab">Labels .lab</a><a id="Labels-.lab-1"></a><a class="docs-heading-anchor-permalink" href="#Labels-.lab" title="Permalink"></a></h4><table><tr><th style="text-align: left">Number of lines</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left">First line</td><td style="text-align: left">Contains a space-separated list of labels with index <code>i=&quot;label&quot;</code>. The first two must be <code>0=&quot;init&quot; 1=&quot;deadlock&quot;</code>.</td></tr><tr><td style="text-align: left">All remaining lines</td><td style="text-align: left">Contains <code>i: j1 j2 j3 ...</code> where <code>i</code> is a state index and <code>j1 j2 j3 ...</code> are space-separated indices of labels associated with state <code>i</code>.</td></tr></table><h4 id="Transitions-.tra"><a class="docs-heading-anchor" href="#Transitions-.tra">Transitions .tra</a><a id="Transitions-.tra-1"></a><a class="docs-heading-anchor-permalink" href="#Transitions-.tra" title="Permalink"></a></h4><table><tr><th style="text-align: left">Number of lines</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left">First line</td><td style="text-align: left"><code>num_states num_choices num_transitions</code> where <code>num_state</code> must match the number in the state file.</td></tr><tr><td style="text-align: left">Following <code>num_transitions</code> lines</td><td style="text-align: left">A list of transition probabilities with the format <code>src_idx act_idx dest_idx [p_lower,p_upper] action</code>.</td></tr></table><h4 id="Property-.pctl"><a class="docs-heading-anchor" href="#Property-.pctl">Property .pctl</a><a id="Property-.pctl-1"></a><a class="docs-heading-anchor-permalink" href="#Property-.pctl" title="Permalink"></a></h4><table><tr><th style="text-align: left">Number of lines</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left">First line</td><td style="text-align: left">PRISM property specification</td></tr></table><h2 id="bmdp-tool"><a class="docs-heading-anchor" href="#bmdp-tool">bmdp-tool</a><a id="bmdp-tool-1"></a><a class="docs-heading-anchor-permalink" href="#bmdp-tool" title="Permalink"></a></h2><p><a href="https://github.com/aria-systems-group/bmdp-tool">bmdp-tool</a> data format is similar to the PRISM explicit format transition probability files, where transition probabilities are stored line-by-line with source, action, destination, and probability bounds in ASCII. Key differences include no explicit listing of states, the fact that it only supports reachability properties, and that terminal states are listed directly in the transition probability file. As a result, bmdp-tool data format is a single file. This format lacks information about whether the reachability is finite or infinite time, and hence the reader only returns the set of terminal states.</p><pre><code class="language-julia hljs"># Read
imdp, terminal_states = read_bmdp_tool_file(path)

# Write
write_bmdp_tool_file(path, problem)</code></pre><p>bmdp-tool uses only one ASCII file with the following format:</p><table><tr><th style="text-align: left">Number of lines</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left">First line</td><td style="text-align: left"><code>num_states</code>.</td></tr><tr><td style="text-align: left">Second line</td><td style="text-align: left"><code>num_actions</code> (not to be confused with <code>num_choices</code> of PRISM).</td></tr><tr><td style="text-align: left">Third line</td><td style="text-align: left"><code>num_terminal</code>.</td></tr><tr><td style="text-align: left">The following <code>num_terminal</code> lines</td><td style="text-align: left">Indices (zero-indexed) of terminal states, one per line.</td></tr><tr><td style="text-align: left">The following <code>num_terminal</code> lines</td><td style="text-align: left">Indices (zero-indexed) of terminal states, one per line.</td></tr><tr><td style="text-align: left">All remaining lines</td><td style="text-align: left">A list of transition probabilities with the format <code>src_idx act_idx dest_idx p_lower p_upper</code>.</td></tr></table><div class="admonition is-category-terminology"><header class="admonition-header">Choices vs actions</header><div class="admonition-body"><p>In PRISM, the number of choices which is listed in the transition file is the sum of the number of feasible actions in each state. In bmdp-tool, the number of actions is the total number of different actions in the model, i.e. in each state up to <code>num_actions</code> may be feasible. This is a subtle difference, but it is important to be aware of as the parsing in either tool requires the right number to be specified.</p></div></div><h2 id="IntervalMDP.jl"><a class="docs-heading-anchor" href="#IntervalMDP.jl">IntervalMDP.jl</a><a id="IntervalMDP.jl-1"></a><a class="docs-heading-anchor-permalink" href="#IntervalMDP.jl" title="Permalink"></a></h2><p>IntervalMDP.jl also supports a different <em>binary</em> format based on NetCDF to store transition probabilities. We use JSON to store the specification, as storage space for the specification is much less a concern, and because JSON is a widely used, human-readable, file format.</p><pre><code class="language-julia hljs"># Read
imdp = read_intervalmdp_jl_model(model_path)
spec = read_intervalmdp_jl_spec(spec_path)
problem = Problem(imdp, spec)

problem = read_intervalmdp_jl(model_path, spec_path)

# Write
write_intervalmdp_jl_model(model_path, imdp_or_problem)
write_intervalmdp_jl_spec(spec_path, spec_or_problem)</code></pre><p>The new format proposed uses netCDF, which is based on HDF5 underlying, to store transition probabilities, and a JSON file to store the specification. Transition probabilities are stored in CSC-format, which is unfortunately not natively stored in netCDF, nor any widely available format. Therefore, we store the following attributes and variables in the netCDF file:</p><p><strong>Global attributes:</strong></p><ul><li><code>num_states</code></li><li><code>model</code> (either <code>imc</code> or <code>imdp</code>)</li><li><code>format</code> (assert <code>sparse_csc</code>)</li><li><code>rows</code> (assert <code>to</code>)</li><li><code>cols</code> (assert <code>from</code> if model is <code>imc</code> and <code>from/action</code> if model is <code>imdp</code>)</li></ul><p><strong>Variables:</strong></p><ul><li><code>lower_colptr</code> (integer)</li><li><code>lower_rowval</code> (integer)</li><li><code>lower_nzval</code> (floating point)</li><li><code>upper_colptr</code> (integer)</li><li><code>upper_rowval</code> (integer)</li><li><code>upper_nzval</code> (floating point)</li><li><code>initial_states</code> (integer)</li><li><code>stateptr</code> (integer, only for <code>imdp</code>)</li><li><code>action_vals</code> (any netCDF supported type, only for <code>imdp</code>)</li></ul><p>We store the specification in a JSON format where the structure depends on the type of specification. For a reachability-like specification, the specification is the following format</p><pre><code class="language-json hljs">{
    &quot;property&quot;: {
        &quot;type&quot;: &lt;&quot;reachability&quot;|&quot;reach-avoid&quot;&gt;,
        &quot;infinite_time&quot;: &lt;true|false&gt;,
        &quot;time_horizon&quot;: &lt;positive int&gt;,
        &quot;eps&quot;: &lt;positive float&gt;,
        &quot;reach&quot;: [&lt;state_index:positive int&gt;],
        &quot;avoid&quot;: [&lt;state_index:positive int&gt;]
    },
    &quot;satisfaction_mode&quot;: &lt;&quot;pessimistic&quot;|&quot;optimistic&quot;&gt;,
    &quot;strategy_mode&quot;: &lt;&quot;minimize&quot;|&quot;maximize&quot;&gt;
}</code></pre><p>For a finite horizon property, <code>eps</code> is excluded, and similarly for an infinite horizon property, <code>time\_horizon</code> is excluded.  For a proper reachability property, the <code>avoid</code>-field is excluded.</p><p>If we instead want to optimize a reward, the format is the following</p><pre><code class="language-json hljs">{
    &quot;property&quot;: {
        &quot;type&quot;: &quot;reward&quot;,
        &quot;infinite_time&quot;: &lt;true|false&gt;,
        &quot;time_horizon&quot;: &lt;positive int&gt;,
        &quot;eps&quot;: &lt;positive float&gt;,
        &quot;reward&quot;: [&lt;reward_per_state_index:float&gt;]
        &quot;discount&quot; &lt;float:0-1&gt;
    },
    &quot;satisfaction_mode&quot;: &lt;&quot;pessimistic&quot;|&quot;optimistic&quot;&gt;,
    &quot;strategy_mode&quot;: &lt;&quot;minimize&quot;|&quot;maximize&quot;&gt;
}</code></pre><p>[1] Kwiatkowska, Marta, Gethin Norman, and David Parker. &quot;PRISM 4.0: Verification of probabilistic real-time systems.&quot; Computer Aided Verification: 23rd International Conference, CAV 2011, Snowbird, UT, USA, July 14-20, 2011. Proceedings 23. Springer Berlin Heidelberg, 2011.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../usage/">« Usage</a><a class="docs-footer-nextpage" href="../theory/">Theory »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 3 January 2025 13:11">Friday 3 January 2025</span>. Using Julia version 1.10.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
